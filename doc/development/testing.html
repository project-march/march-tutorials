

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Testing &mdash; Project March Melodic documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'Melodic',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/override.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Style Guide" href="style_guide.html" />
    <link rel="prev" title="Continuous Integration" href="../continuous_integration/continuous_integration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create_your_workspace.html">Create your workspace</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/robot_model.html">Robot model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/ros_control.html">ros_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/rqt.html">RQT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/ros_bag.html">ROS bag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/gazebo.html">Gazebo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/smach.html">SMACH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/event_stream_processing.html">Event stream Processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Using the March Exoskeleton</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html">High level overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html">Connecting to the exoskeleton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html">How to airgait</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html">How to view live data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html">Log files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html">Using the gait generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html">Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_pressure_soles.html">Using the pressure soles</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../continuous_integration/continuous_integration.html">Continuous Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-tests-locally">Running the tests locally</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-catkin-lint">Running catkin_lint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#general-guidelines-to-writing-tests">General guidelines to writing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-your-own-tests">Writing your own tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="style_guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_a_new_gait.html">Add a new gait</a></li>
</ul>
<p class="caption"><span class="caption-text">March Packages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_data_collector.html">march_data_collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_description.html">march_description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_fake_sensor_data.html">march_fake_sensor_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gain_scheduling.html">march_gain_scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_files.html">march_gait_files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware.html">march_hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_builder.html">march_hardware_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_interface.html">march_hardware_interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_imu_manager.html">march_imu_manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_input_device.html">march_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_launch.html">march_launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_input_device.html">march_rqt_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_software_check.html">march_rqt_software_check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_safety.html">march_safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_classes.html">march_shared_classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_resources.html">march_shared_resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_state_machine.html">march_state_machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_selection.html">march_gait_selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_simulation.html">march_simulation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Project March</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Testing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/project-march/tutorials/blob/master/doc/development/testing.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>This page describes the process of running and writing automated tests for
the march packages.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>In order to run the tests you must already have a workspace setup.
See <a class="reference internal" href="../getting_started/create_your_workspace.html#create-your-workspace-label"><span class="std std-ref">Create your workspace</span></a>.</p>
</div>
<div class="section" id="running-the-tests-locally">
<h2>Running the tests locally<a class="headerlink" href="#running-the-tests-locally" title="Permalink to this headline">¶</a></h2>
<p>Running all the tests within your workspace can be done by the following commands:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="c1"># colcon must be run from your workspace root</span>
<span class="n">cd</span> <span class="o">~/</span><span class="n">march_ws</span>
<span class="n">colcon</span> <span class="n">build</span>
<span class="n">colcon</span> <span class="n">test</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">build</span></code> step also builds the automated tests, so it is important to run
<code class="docutils literal"><span class="pre">build</span></code> when you modify tests. The <code class="docutils literal"><span class="pre">test</span></code> step will run all the tests and
will fail when tests fail. Colcon also gives the possibility to review the test
results and give more information on any failing tests.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">colcon</span> <span class="n">test</span><span class="o">-</span><span class="n">result</span> <span class="o">--</span><span class="nb">all</span>
</pre></div>
</div>
<p>This will output every test result of every package that includes tests.</p>
<p>When you are writing tests for a specific package you do not want to run all
the tests every time. Colcon also gives an option to only build tests for
specified packages.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">colcon</span> <span class="n">test</span> <span class="o">--</span><span class="n">packages</span><span class="o">-</span><span class="n">select</span> <span class="n">march_some_package</span> <span class="n">march_some_other_package</span>
</pre></div>
</div>
<div class="section" id="running-catkin-lint">
<h3>Running catkin_lint<a class="headerlink" href="#running-catkin-lint" title="Permalink to this headline">¶</a></h3>
<p>Another tool that is used to lint packages is <a class="reference external" href="https://github.com/fkie/catkin_lint">catkin_lint</a>.
<code class="docutils literal"><span class="pre">catkin_lint</span></code> checks the package manifest and CMake configuration files for
any common errors. This command can be run anywhere in the workspace and will recurse into directories.
So in order to check all packages you should run this command in the root of the workspace.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">catkin_lint</span> <span class="o">-</span><span class="n">W2</span> <span class="o">--</span><span class="n">explain</span> <span class="o">--</span><span class="n">strict</span> <span class="o">.</span>
</pre></div>
</div>
<p>This will output any notes, warnings or errors with an explanation. This
command is normally run when you have created a new package or made changes to
a <code class="docutils literal"><span class="pre">package.xml</span></code> or <code class="docutils literal"><span class="pre">CMakeLists.txt</span></code> file.</p>
</div>
</div>
<div class="section" id="general-guidelines-to-writing-tests">
<h2>General guidelines to writing tests<a class="headerlink" href="#general-guidelines-to-writing-tests" title="Permalink to this headline">¶</a></h2>
<p>Here are some rules of thumb to follow when writing tests:</p>
<ol class="arabic simple">
<li>Write short understandable tests.</li>
<li>Separate setup code that is necessary for every test.</li>
<li>Do not depend on writing and reading from external files.</li>
<li>Do not depend on timing in your tests.</li>
<li>Use one <code class="docutils literal"><span class="pre">assert</span></code> per test (i.e. only test one function)</li>
<li>If possible, every method should have at least one unit test</li>
<li>Make a test for every edge case!</li>
<li>Usually, your test code is about as long as your normal code.</li>
</ol>
<p>Next to these rules there exist some conventions in structuring tests:</p>
<ol class="arabic simple">
<li>Put your tests in a separate directory next to <code class="docutils literal"><span class="pre">src/</span></code> named <code class="docutils literal"><span class="pre">test/</span></code>.</li>
<li>The same as for all filenames, name the test files using snake_case.</li>
<li>Put rostest <code class="docutils literal"><span class="pre">.test</span></code> launch files inside <code class="docutils literal"><span class="pre">test/launch/</span></code>.</li>
<li>Put rostest source files inside <code class="docutils literal"><span class="pre">test/rostest/</span></code>.</li>
<li>If writing unittests and rostests for Python, put the unit tests inside <code class="docutils literal"><span class="pre">test/unittests/</span></code>.</li>
<li>Put necessary resources, e.g. files, for tests in a separate directory inside <code class="docutils literal"><span class="pre">test/</span></code>.</li>
</ol>
<p>See the March packages for examples on how to write and structure tests.</p>
</div>
<div class="section" id="writing-your-own-tests">
<h2>Writing your own tests<a class="headerlink" href="#writing-your-own-tests" title="Permalink to this headline">¶</a></h2>
<p>For testing ROS packages we make a distinction between two different kinds of tests.</p>
<ol class="arabic simple">
<li>Unit tests (library level)</li>
<li>Integration tests (node level)</li>
</ol>
<p>Also, see the <a class="reference external" href="https://wiki.ros.org/Quality/Tutorials/UnitTesting">ROS wiki on testing</a>.
The unit tests are different for C++ and python projects. C++ projects use the
<a class="reference external" href="https://github.com/google/googletest">gtest</a> framework, whereas Python projects use
<a class="reference external" href="http://pythontesting.net/framework/unittest/unittest-introduction/">unittest</a>.
For node level tests, <a class="reference external" href="https://wiki.ros.org/rostest">rostest</a> is used.
Rostest uses launch files to launch the nodes under test and the actual tests.
See the following tutorials on writing tests using ROS:</p>
<ul class="simple">
<li><a class="reference external" href="https://wiki.ros.org/gtest">Writing C++ tests with gtest</a></li>
<li><a class="reference external" href="https://wiki.ros.org/unittest">Writing Python tests with unittest</a></li>
<li><a class="reference external" href="https://wiki.ros.org/rostest/Writing">Writing rostest files</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="style_guide.html" class="btn btn-neutral float-right" title="Style Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../continuous_integration/continuous_integration.html" class="btn btn-neutral float-left" title="Continuous Integration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Project March
      <span class="lastupdated">
        Last updated on Jun 16, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>