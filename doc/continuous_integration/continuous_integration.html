

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Continuous Integration &mdash; Project March Melodic documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'Melodic',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/override.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Testing" href="../development/testing.html" />
    <link rel="prev" title="Documentation" href="../development/documentation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create_your_workspace.html">Create your workspace</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/robot_model.html">Robot model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/ros_control.html">ros_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/rqt.html">RQT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/ros_bag.html">ROS bag</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/gazebo.html">Gazebo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/smach.html">SMACH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_tools/event_stream_processing.html">Event stream Processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Using the March Exoskeleton</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html">High level overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html">Connecting to the exoskeleton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html">How to airgait</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html">How to view live data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html">Log files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html">Using the gait generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html">Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_pressure_soles.html">Using the pressure soles</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../development/documentation.html">Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Continuous Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#build-notifications">Build Notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-industrial-ci">Configuring Industrial CI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-industrial-ci">Running Industrial CI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complete-travis-configuration">Complete Travis Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-travis-ci-on-repository">Setting up Travis CI on Repository</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/style_guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/add_a_new_gait.html">Add a new gait</a></li>
</ul>
<p class="caption"><span class="caption-text">March Packages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_data_collector.html">march_data_collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_description.html">march_description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_fake_sensor_data.html">march_fake_sensor_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gain_scheduling.html">march_gain_scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_files.html">march_gait_files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware.html">march_hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_builder.html">march_hardware_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_interface.html">march_hardware_interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_imu_manager.html">march_imu_manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_input_device.html">march_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_launch.html">march_launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_input_device.html">march_rqt_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_software_check.html">march_rqt_software_check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_safety.html">march_safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_classes.html">march_shared_classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_resources.html">march_shared_resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_state_machine.html">march_state_machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_selection.html">march_gait_selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_simulation.html">march_simulation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Project March</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Continuous Integration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/project-march/tutorials/blob/master/doc/continuous_integration/continuous_integration.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="continuous-integration">
<h1>Continuous Integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will describe the current Continuous Integration (CI) setup and
provide a tutorial on how to setup a new repository with CI.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before reading this tutorial it is useful to read the documentation on <a class="reference external" href="https://docs.travis-ci.com/">Travis CI</a>.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>The march repositories all use <a class="reference external" href="https://travis-ci.com/project-march">open source Travis CI</a>
for builds, which run on commit pushes. There are no extra builds configured
for pull requests since branches have to be up to date with the target branch
in order to merge. You can download a template <a class="reference external" href="https://github.com/project-march/tutorials/tree/master/doc/continuous_integration/template.travis.yml">.travis.yml</a>
for new repositories.</p>
<div class="section" id="build-notifications">
<h3>Build Notifications<a class="headerlink" href="#build-notifications" title="Permalink to this headline">¶</a></h3>
<p>Travis builds can send notifications when builds succeed or fail. By default,
Travis sends emails about builds. The march repositories disable the email
notifications and enable secure slack integration. This is done by the
following setting in <code class="docutils literal"><span class="pre">.travis.yml</span></code>.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">notifications</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">slack</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;secure string&gt;</span>
  <span class="l l-Scalar l-Scalar-Plain">email</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">&lt;secure</span> <span class="pre">string&gt;</span></code> is replaced by an encrypted connection string from
slack. See <a class="reference external" href="https://docs.travis-ci.com/user/notifications/#configuring-slack-notifications">the Travis docs on slack integration</a>.</p>
</div>
<div class="section" id="configuring-industrial-ci">
<h3>Configuring Industrial CI<a class="headerlink" href="#configuring-industrial-ci" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">.travis.yml</span></code> scripts use the master branch of
<a class="reference external" href="https://github.com/ros-industrial/industrial_ci/tree/master">ros-industrial/industrial_ci</a> tools to run
various tests. Industrial CI makes it easy to set things up and it is a
structured way of running CI. ROS industrial CI is configured using environment
variables.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">env</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">global</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROS_REPO=ros</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">BUILDER=colcon</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CATKIN_LINT=pedantic</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">UPSTREAM_WORKSPACE=&#39;.rosinstall&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">jobs</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Melodic&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">env</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ROS_DISTRO=melodic</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">global</span></code> variables are used for every Travis build, whereas the
variables inside <code class="docutils literal"><span class="pre">jobs/include</span></code> are used for different builds. So the template runs one
job on Melodic. It is possible to add new jobs, for example, flake8 and
clang-format. <code class="docutils literal"><span class="pre">BUILDER</span></code> configures to use <code class="docutils literal"><span class="pre">colcon</span></code> as build tool,
since that is not the default for ROS1 packages. <code class="docutils literal"><span class="pre">CATKIN_LINT</span></code> configures
to run <code class="docutils literal"><span class="pre">catkin_lint</span></code> and fail on warnings and give error descriptions.</p>
<p>Industrial CI works with <a class="reference external" href="https://github.com/ros-industrial/industrial_ci/blob/master/doc/index.rst#workspace-management">different workspaces</a>.
The template uses the <code class="docutils literal"><span class="pre">UPSTREAM_WORKSPACE</span></code>. This workspace contains packages
necessary to build the current package. So it downloads the repositories
defined in <code class="docutils literal"><span class="pre">dependencies.rosinstall</span></code> file and builds the current package
against those. This type of workspace is used for example by
<a class="reference external" href="https://github.com/project-march/gait-generation/tree/develop/.travis.yml">gait-generation</a> and <a class="reference external" href="https://github.com/project-march/simulation/tree/develop/.travis.yml">simulation</a>.
The other type of workspace that can be used is the <code class="docutils literal"><span class="pre">DOWNSTREAM_WORKSPACE</span></code>.
The downstream workspace contains packages that depend on the current package.
It builds and runs tests on downstream packages to check if there are any
breaking changes. This is currently only used in <a class="reference external" href="https://github.com/project-march/march/tree/develop/.travis.yml">march</a>.</p>
<p>Finally, there is the <code class="docutils literal"><span class="pre">AFTER_SCRIPT</span></code> option. This runs the given script after
all the default tests. Currently, it is set in the template to run roslint on
the target packages. The build can fail if the after script fails.</p>
</div>
<div class="section" id="running-industrial-ci">
<h3>Running Industrial CI<a class="headerlink" href="#running-industrial-ci" title="Permalink to this headline">¶</a></h3>
<p>Industrial CI is run by cloning the <code class="docutils literal"><span class="pre">industrial_ci</span></code> master branch and running
the <code class="docutils literal"><span class="pre">travis.sh</span></code> script. The master branch currently supports <code class="docutils literal"><span class="pre">colcon</span></code> as a
build tool.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="c1"># clone and run industrial_ci</span>
<span class="l l-Scalar l-Scalar-Plain">install</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git clone --quiet --depth 1 https://github.com/ros-industrial/industrial_ci.git .industrial_ci -b master</span>
<span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">.industrial_ci/travis.sh</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-travis-configuration">
<h3>Complete Travis Configuration<a class="headerlink" href="#complete-travis-configuration" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># This config uses industrial_ci (https://github.com/ros-industrial/industrial_ci.git).</span>
<span class="c1"># For troubleshooting, see readme (https://github.com/ros-industrial/industrial_ci/blob/master/README.rst)</span>

<span class="l l-Scalar l-Scalar-Plain">os</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">linux</span>
<span class="l l-Scalar l-Scalar-Plain">language</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">generic</span> <span class="c1"># optional, just removes the language badge</span>

<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">docker</span>

<span class="l l-Scalar l-Scalar-Plain">notifications</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">slack</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">secure</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;secure string&gt;</span>
  <span class="l l-Scalar l-Scalar-Plain">email</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="l l-Scalar l-Scalar-Plain">git</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">quiet</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span> <span class="c1"># optional, silences the cloning of the target repository</span>

<span class="c1"># configure the build environment(s)</span>
<span class="c1"># https://github.com/ros-industrial/industrial_ci/blob/master/doc/index.rst#variables-you-can-configure</span>
<span class="l l-Scalar l-Scalar-Plain">env</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">global</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ROS_REPO=ros</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">BUILDER=colcon</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CATKIN_LINT=pedantic</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">UPSTREAM_WORKSPACE=&#39;.rosinstall&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">jobs</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">include</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Melodic&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">env</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ROS_DISTRO=melodic</span>

<span class="c1"># clone and run industrial_ci</span>
<span class="l l-Scalar l-Scalar-Plain">install</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">git clone --quiet --depth 1 https://github.com/ros-industrial/industrial_ci.git .industrial_ci -b master</span>
<span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">.industrial_ci/travis.sh</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="setting-up-travis-ci-on-repository">
<h2>Setting up Travis CI on Repository<a class="headerlink" href="#setting-up-travis-ci-on-repository" title="Permalink to this headline">¶</a></h2>
<p>These steps assume you already have a public Project March repository with ROS
packages and you are a member of the Project March organization on GitHub.</p>
<ol class="arabic simple">
<li>Go to <a class="reference external" href="https://travis-ci.com/organizations/project-march/repositories">Project March Travis CI settings</a></li>
<li>Enable Travis for your repository</li>
<li>Travis will only start building once a <code class="docutils literal"><span class="pre">.travis.yml</span></code> file is present in
the master branch, so add the template to the root of your repository.</li>
<li>If the packages in your repository need dependencies or have dependencies
on other march repositories add those to a <code class="docutils literal"><span class="pre">.rosinstall</span></code> file and add
configuration for upstream and/or downstream.</li>
<li><a class="reference external" href="https://docs.travis-ci.com/user/notifications/#configuring-slack-notifications">Create a secure slack connection string</a> and replace the value.</li>
<li>Push it to the master branch and wait for your build.</li>
<li>Good luck!</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../development/testing.html" class="btn btn-neutral float-right" title="Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../development/documentation.html" class="btn btn-neutral float-left" title="Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Project March
      <span class="lastupdated">
        Last updated on Jun 16, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>