

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>march_state_machine &mdash; Project March Melodic documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Project March Melodic documentation" href="../../index.html"/>
        <link rel="next" title="march_simulation" href="march_simulation.html"/>
        <link rel="prev" title="march_shared_resources" href="march_shared_resources.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108532843-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-108532843-1');
  </script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        <a href="../../index.html">
          <img src="../../_static/logo.png"/>
          <span>Exoskeleton Technology</span>
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create_your_workspace.html">Create your workspace</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/create_your_workspace.html#install-ros-and-colcon">Install ROS and Colcon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/create_your_workspace.html#create-a-workspace">Create A Workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/create_your_workspace.html#download-the-march-source-code">Download the march source code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/create_your_workspace.html#with-write-access">With write access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/create_your_workspace.html#without-write-access">Without write access</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/create_your_workspace.html#build-your-workspace">Build your Workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/create_your_workspace.html#automated-script">Automated script</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Useful ROS tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/robot_model.html">Robot model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#tf2">tf2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#urdf">urdf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#joint-state-publisher">joint_state_publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#robot-state-publisher">robot_state_publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#rviz">rviz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/robot_model.html#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/ros_control.html">ros_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/rqt.html">RQT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/rqt.html#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/ros_bag.html">ROS bag</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/ros_bag.html#recording-bags">Recording bags</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/gazebo.html">Gazebo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_ros_tools/smach.html">SMACH</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/smach.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful_ros_tools/smach.html#smach-viewer">smach_viewer</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using the March Exoskeleton</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html">High level overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html#simulation-versus-exoskeleton">Simulation versus Exoskeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html#input-device">Input Device</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html">Connecting to the exoskeleton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#preparation-before-connecting">Preparation before connecting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#running-commands-on-the-exoskeleton-computer-ssh">Running commands on the exoskeleton computer (SSH)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#ros-master-uri">ROS Master URI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#ros-ip">ROS IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#add-march-network-to-hosts-file">Add March network to hosts file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html#test-ros-on-multiple-devices">Test ROS on multiple devices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html">How to airgait</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#airgait-on-the-exoskeleton-directly">Airgait on the exoskeleton directly</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#the-setup">The setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#start-up">Start up</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#remote-airgait">Remote airgait</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#id1">The setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html#id2">Start up</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html">How to view live data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html#id1">rqt_multiplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html">Log files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html#rosbag">Rosbag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html#exoskeleton">Exoskeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html#cloudstation">Cloudstation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html#uploading-the-logs">Uploading the logs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html">Using the gait generator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#the-basics">The Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#preview">Preview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#duration">Duration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#velocity-markers">Velocity Markers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#mirroring">Mirroring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#import-export">Import/Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html#publish">Publish</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html">Error Codes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e100-invalid-actuation-mode"><code class="docutils literal"><span class="pre">E100</span></code>: Invalid actuation mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e101-invalid-actuate-position"><code class="docutils literal"><span class="pre">E101</span></code>: Invalid actuate position</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e102-encoder-reset"><code class="docutils literal"><span class="pre">E102</span></code>: Encoder reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e103-outside-hard-limits"><code class="docutils literal"><span class="pre">E103</span></code>: Outside hard limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e104-target-exceeds-max-difference"><code class="docutils literal"><span class="pre">E104</span></code>: Target exceeds max difference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e105-target-torque-exceeds-max-torque"><code class="docutils literal"><span class="pre">E105</span></code>: Target torque exceeds max torque</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e106-pdo-object-not-defined"><code class="docutils literal"><span class="pre">E106</span></code>: PDO object not defined</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e107-pdo-register-overflow"><code class="docutils literal"><span class="pre">E107</span></code>: PDO register overflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e108-writing-initial-settings-failed"><code class="docutils literal"><span class="pre">E108</span></code>: Writing initial settings failed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e109-no-socket-connection"><code class="docutils literal"><span class="pre">E109</span></code>: No socket connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e110-not-all-slaves-found"><code class="docutils literal"><span class="pre">E110</span></code>: Not all slaves found</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e111-failed-to-reach-operational-state"><code class="docutils literal"><span class="pre">E111</span></code>: Failed to reach operational state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e112-invalid-encoder-resolution"><code class="docutils literal"><span class="pre">E112</span></code>: Invalid encoder resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e114-invalid-range-of-motion"><code class="docutils literal"><span class="pre">E114</span></code>: Invalid range of motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e115-invalid-slave-configuration"><code class="docutils literal"><span class="pre">E115</span></code>: Invalid slave configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e116-not-allowed-to-actuate"><code class="docutils literal"><span class="pre">E116</span></code>: Not allowed to actuate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e117-invalid-slave-index"><code class="docutils literal"><span class="pre">E117</span></code>: Invalid slave index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html#e999-unknown-error"><code class="docutils literal"><span class="pre">E999</span></code>: Unknown error</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/documentation.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/documentation.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/documentation.html#building-locally">Building locally</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#clone-the-repository">Clone the repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#install-rosdoc-lite-and-sphinx">Install rosdoc_lite and Sphinx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#install-gem-and-html-proofer">Install Gem and html-proofer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#install-additional-dependencies">Install Additional dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#generate-the-html">Generate the html</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/documentation.html#browser-sync-optional">Browser sync (Optional)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/documentation.html#deploy-with-travis">Deploy with Travis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/documentation.html#add-a-new-tutorial">Add a new tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../continuous_integration/continuous_integration.html">Continuous Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../continuous_integration/continuous_integration.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../continuous_integration/continuous_integration.html#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../continuous_integration/continuous_integration.html#build-notifications">Build Notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../continuous_integration/continuous_integration.html#configuring-industrial-ci">Configuring Industrial CI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../continuous_integration/continuous_integration.html#running-industrial-ci">Running Industrial CI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../continuous_integration/continuous_integration.html#complete-travis-configuration">Complete Travis Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../continuous_integration/continuous_integration.html#setting-up-travis-ci-on-repository">Setting up Travis CI on Repository</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/testing.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/testing.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/testing.html#running-the-tests-locally">Running the tests locally</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/testing.html#running-catkin-lint">Running catkin_lint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/testing.html#general-guidelines-to-writing-tests">General guidelines to writing tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/testing.html#writing-your-own-tests">Writing your own tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/testing.html#writing-c-unit-tests">Writing C++ unit tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/testing.html#writing-c-node-tests">Writing C++ node tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/testing.html#writing-python-unit-tests">Writing python unit tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/testing.html#writing-python-node-tests">Writing python node tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/style_guide.html">Style Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/style_guide.html#running-style-checkers">Running style checkers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/style_guide.html#id2">clang-format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/style_guide.html#id3">flake8</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/add_a_new_gait.html">Add a new gait</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/add_a_new_gait.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/add_a_new_gait.html#create-new-gait-files">Create new gait files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/add_a_new_gait.html#extend-the-state-machine">Extend the state machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/add_a_new_gait.html#add-a-gait-button-to-the-developer-input-device">Add a gait button to the developer input device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/add_a_new_gait.html#add-the-gait-to-the-input-device">Add the gait to the input device</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">March Packages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="march_description.html">march_description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_description.html#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_fake_sensor_data.html">march_fake_sensor_data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_fake_sensor_data.html#implemented-sensors">Implemented sensors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_fake_sensor_data.html#temperature-sensors">Temperature sensors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="march_fake_sensor_data.html#how-to-use">How to use</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_gait_files.html">march_gait_files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_gait_files.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_gait_files.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_gait_files.html#structure">Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_gait_files.html#clarification">Clarification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_hardware.html">march_hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#class-structure">Class Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#example-usage">Example usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#ethercat">EtherCAT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_hardware.html#ethercatmaster">EthercatMaster</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_hardware.html#pdo-messages">PDO messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_hardware.html#sdo-messages">SDO messages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#power-distribution-board">Power Distribution Board</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#exceptions">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware.html#ros-api">ROS API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_hardware_builder.html">march_hardware_builder</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_hardware_builder.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware_builder.html#ros-api">ROS API</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_hardware_builder.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_hardware_builder.html#using-the-package">Using the package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_hardware_interface.html">march_hardware_interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="march_imu_manager.html">march_imu_manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_imu_manager.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_imu_manager.html#launch">Launch</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_imu_manager.html#interaction">Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_imu_manager.html#placement">Placement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_imu_manager.html#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_input_device.html">march_input_device</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_input_device.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_input_device.html#communication">Communication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#sending-messages">Sending messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#receiving-messages">Receiving messages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_input_device.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#set-correct-ubuntu-permissions">Set correct ubuntu permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#how-to-run-wired">How to run wired</a><ul>
<li class="toctree-l4"><a class="reference internal" href="march_input_device.html#upload-the-code-on-the-input-device">Upload the code on the input device</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_input_device.html#start-the-software">Start the software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#how-to-run-wireless">How to run wireless</a><ul>
<li class="toctree-l4"><a class="reference internal" href="march_input_device.html#id1">Upload the code on the input device</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_input_device.html#id2">Start the software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="march_input_device.html#how-to-add-a-gait">How to add a gait</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_launch.html">march_launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="march_rqt_input_device.html">march_rqt_input_device</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_input_device.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_input_device.html#launching">Launching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_input_device.html#ros-api">ROS API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_input_device.html#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_input_device.html#published-topics">Published Topics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_input_device.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_input_device.html#add-a-new-button">Add a new button</a><ul>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_input_device.html#create-a-new-publisher">Create a new publisher</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_input_device.html#create-a-publish-function">Create a publish function</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_input_device.html#create-a-button-object">Create a button object</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_input_device.html#add-it-to-the-march-button-layout">Add it to the march_button_layout</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_rqt_software_check.html">march_rqt_software_check</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_software_check.html#ros-api">ROS API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_software_check.html#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_software_check.html#parameters">Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_software_check.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_software_check.html#adding-a-software-check">Adding a software check</a><ul>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_software_check.html#add-it-to-the-ui">Add it to the UI</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_software_check.html#creating-your-software-check">Creating your software check</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_software_check.html#add-it-to-the-checkrunner">Add it to the CheckRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="march_rqt_software_check.html#creating-the-executable-optional">Creating the executable (optional)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_rqt_software_check.html#faq">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_rqt_software_check.html#how-do-i-see-which-checks-exist">How do I see which checks exist?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_safety.html">march_safety</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_safety.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_safety.html#error-severity">Error severity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#warning">Warning</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#non-fatal">Non-Fatal</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#fatal">Fatal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_safety.html#ros-api">ROS API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#subscribed-topics">Subscribed Topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#published-topics">Published Topics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="march_safety.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#add-new-safety-rule-to-existing-safetytype">Add new safety rule to existing SafetyType</a></li>
<li class="toctree-l3"><a class="reference internal" href="march_safety.html#create-new-safetytype">Create new SafetyType</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_shared_classes.html">march_shared_classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_shared_classes.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_shared_classes.html#the-gait-classes">The Gait classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="march_shared_classes.html#usage">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_shared_resources.html">march_shared_resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_shared_resources.html#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">march_state_machine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#behavior">Behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#launch">LAUNCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="#healthy">HEALTHY</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error">ERROR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shutdown">SHUTDOWN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ros-api">ROS API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subscribed-topics">Subscribed Topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#published-topics">Published Topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#services">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-a-state-to-the-state-machine">Add a state to the state machine</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="march_simulation.html">march_simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="march_simulation.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_simulation.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_simulation.html#code-structure">Code structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="march_simulation.html#com-controller-plugin">CoM controller plugin</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Project March</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="header-override">
          <p>
            <a href="http://projectmarch.nl">March Website</a><br/>
          </p>
        </div>
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/project-march/tutorials/blob/master/doc/march_packages/march_state_machine.rst" class="fa fa-github"> Edit on GitHub</a>
        
      
    </li>
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>march_state_machine</li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="march-state-machine">
<span id="march-state-machine-label"></span><h1>march_state_machine<a class="headerlink" href="#march-state-machine" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The march_state_machine contains the general behavior of the March exoskeleton. Simply
put, after launching the exoskeleton the state machine decides which gaits
can be performed. The state machine also knows which gait can be executed in
every possible state. For example after sitting you can stand-up, but you
cannot walk.</p>
<p>We are using an hierarchical state machine, which is a state machine whose
states can be state machines as well. We also use SMACH, this is a task-level
architecture for rapidly creating complex robot behavior(see <a class="reference internal" href="../useful_ros_tools/smach.html#smach-label"><span class="std std-ref">SMACH</span></a>).</p>
</div>
<div class="section" id="behavior">
<h2>Behavior<a class="headerlink" href="#behavior" title="Permalink to this headline">¶</a></h2>
<p>There are 4 general states in the state machine: <strong>LAUNCH</strong>, <strong>HEALTHY</strong>,
<strong>SHUTDOWN</strong>, <strong>ERROR</strong>, where <strong>LAUNCH</strong> and <strong>HEALTHY</strong> are also state
machines. As mentioned above this is possible in a hierarchical state machine.</p>
<div class="figure align-center">
<img alt="../../_images/march_state_machine.png" src="../../_images/march_state_machine.png" />
</div>
<p>The above image is a screenshot from the
<a class="reference external" href="https://wiki.ros.org/smach_viewer">smach_viewer</a>. This visualizes the states
of the state machine and makes active ones green. This screenshot only shows
the high level states. The smach_viewer can be launched with the
<code class="docutils literal"><span class="pre">state_machine_viewer</span></code> launch argument, which defaults to <code class="docutils literal"><span class="pre">false</span></code>.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">march_state_machine</span> <span class="n">state_machine</span><span class="o">.</span><span class="n">launch</span> <span class="n">state_machine_viewer</span><span class="p">:</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When you get an error saying that it failed to load Gtk, you need to install
<code class="docutils literal"><span class="pre">python-gi-cairo</span></code> from the Ubuntu repositories:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">gi</span><span class="o">-</span><span class="n">cairo</span>
</pre></div>
</div>
<p class="last">See <a class="reference external" href="https://github.com/ros-visualization/executive_smach_visualization/issues/20">https://github.com/ros-visualization/executive_smach_visualization/issues/20</a>
for more info.</p>
</div>
<div class="section" id="launch">
<h3>LAUNCH<a class="headerlink" href="#launch" title="Permalink to this headline">¶</a></h3>
<p>Launch starts with a <strong>WAIT FOR GAIT SERVER</strong> state. This state waits for the
gait selection server to be available, since that is where the state machine
sends requests for executing gaits.</p>
</div>
<div class="section" id="healthy">
<h3>HEALTHY<a class="headerlink" href="#healthy" title="Permalink to this headline">¶</a></h3>
<p>When launched successful the <strong>HEALTHY</strong> state machine is active. This part
contains all possible gaits. Besides gaits we also have <em>idle</em> states such as
<strong>STANDING</strong>, <strong>SITTING</strong> and <strong>UNKNOWN</strong>. <strong>UNKNOWN</strong> is the state in which
the current position is not known. This can be on start-up, but also after an
error is thrown and the March exoskeleton did not fully execute the intended gait.
Transitions between <em>idle-states</em> to <em>gait-states</em> are present only when it
is safe to execute this gait at that moment. For example, from the idle state
<strong>SITTING</strong> you can only stand-up.</p>
<p>In this state machine the <strong>SAFETY</strong> state is always active. However, this is
not the only active state. Multiple active states at the same time are called
<a class="reference external" href="http://wiki.ros.org/smach/Tutorials/Concurrent%20States">concurrent states</a>.
The <strong>SAFETY</strong> state is responsible for monitoring possible errors
(see <a class="reference internal" href="march_safety.html#march-safety-label"><span class="std std-ref">march_safety</span></a>). This is done in a concurrent state and can
preempt any active state in the <strong>HEALTHY</strong> state machine when a fatal error
occurs.</p>
</div>
<div class="section" id="error">
<h3>ERROR<a class="headerlink" href="#error" title="Permalink to this headline">¶</a></h3>
<p>After an error is thrown (see <a class="reference internal" href="march_safety.html#march-safety-label"><span class="std std-ref">march_safety</span></a> when this happens),
<strong>SAFETY</strong> state preempts the <strong>HEALTHY</strong> state and <strong>ERROR</strong> will become
active. For now the <strong>ERROR</strong> state will automatically go to <strong>SHUTDOWN</strong>,
but could be used later to recover from errors.</p>
</div>
<div class="section" id="shutdown">
<h3>SHUTDOWN<a class="headerlink" href="#shutdown" title="Permalink to this headline">¶</a></h3>
<p><strong>SHUTDOWN</strong> shuts down ROS when it was called, without ROS being shutdown.
Furthermore, it tries to kill the Gazebo server sending a <code class="docutils literal"><span class="pre">SIGTERM</span></code>, since
Gazebo has trouble shutting down by itself.</p>
</div>
</div>
<div class="section" id="ros-api">
<h2>ROS API<a class="headerlink" href="#ros-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="nodes">
<h3>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h3>
<p><em>march_state_machine</em> - Launches the state machine and keeps track of states.</p>
</div>
<div class="section" id="subscribed-topics">
<h3>Subscribed Topics<a class="headerlink" href="#subscribed-topics" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><em>/march/input_device/instruction</em> (<a class="reference external" href="https://github.com/project-march/march/tree/develop/march_shared_resources/msg/GaitInstruction.msg">march_shared_resources/GaitInstruction</a>)</dt>
<dd>Listens for instructions and executes them when there are possible state transitions.</dd>
</dl>
</div>
<div class="section" id="published-topics">
<h3>Published Topics<a class="headerlink" href="#published-topics" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><em>/march/gait/current</em> (<a class="reference external" href="https://docs.ros.org/melodic/api/std_msgs/html/msg/String.html">std_msgs/String</a>)</dt>
<dd>Publishes the current active gait once when it starts.</dd>
<dt><em>/march/input_device/instruction_response</em> (<a class="reference external" href="https://github.com/project-march/march/tree/develop/march_shared_resources/msg/GaitInstructionResponse.msg">march_shared_resources/GaitInstructionResponse</a>)</dt>
<dd>Publishes whether a gait was accepted, rejected or finished.</dd>
</dl>
</div>
<div class="section" id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><em>/march/state_machine/get_possible_gaits</em> (<a class="reference external" href="https://github.com/project-march/march/tree/develop/march_shared_resources/srv/PossibleGaits.srv">march_shared_resources/PossibleGaits</a>)</dt>
<dd>Returns a list of names of possible gaits than can be executed next.</dd>
<dt><em>/march/state_machine/current_states</em> (<a class="reference external" href="https://github.com/project-march/march/tree/develop/march_shared_resources/srv/CurrentState.srv">march_shared_resources/CurrentState</a>)</dt>
<dd>Returns the current active state and its type.</dd>
</dl>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><em>state_machine/state_machine_viewer</em> (<em>bool</em>, default: <code class="docutils literal"><span class="pre">false</span></code>)</dt>
<dd>Whether to launch the smach_viewer.</dd>
<dt><em>state_machine/unpause</em> (<em>bool</em>, default: <code class="docutils literal"><span class="pre">true</span></code>)</dt>
<dd>Unpauses the simulation, since the Gazebo simulation always starts paused.</dd>
<dt><em>state_machine/sounds</em> (<em>bool</em>, default: <code class="docutils literal"><span class="pre">false</span></code>)</dt>
<dd>Whether to play sounds using the soundplay_node.</dd>
</dl>
</div>
</div>
<div class="section" id="tutorials">
<h2>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-a-state-to-the-state-machine">
<h3>Add a state to the state machine<a class="headerlink" href="#add-a-state-to-the-state-machine" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../development/add_a_new_gait.html#add-gait-label"><span class="std std-ref">Add a new gait</span></a> on how to add a gait state to the <strong>HEALTY</strong> state machine. Adding other non-gait states is similar.</p>
</div>
</div>
</div>


            
            <div class="admonition note">
              <p class="first admonition-title">Open Source Feedback</p>
              <p class="last">See something that needs improvement? Please open a pull request on this <a href="https://github.com/project-march/tutorials/blob/master/doc/march_packages/march_state_machine.rst" class="fa fa-github"> GitHub page</a></p>
            </div>
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="march_simulation.html" class="btn btn-neutral float-right" title="march_simulation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="march_shared_resources.html" class="btn btn-neutral" title="march_shared_resources" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'Melodic',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>